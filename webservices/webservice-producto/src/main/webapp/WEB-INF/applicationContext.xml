<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jaxws="http://cxf.apache.org/jaxws"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd                                                  http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd">

    <!-- Dependency objects -->
    <bean id="productoDao" class="pe.edu.upc.dsd.ws.dao.impl.ProductoDAOImpl" >
      <constructor-arg index="0" ref="sessionFactory" />
    </bean>

    <!-- WebService objects -->
	<import resource="classpath:META-INF/cxf/cxf.xml" />
	<import resource="classpath:META-INF/cxf/cxf-extension-soap.xml" />
	<import resource="classpath:META-INF/cxf/cxf-servlet.xml" />

    <bean id="productoService" class="pe.edu.upc.dsd.ws.ProductoServiceImpl">
      <property name="productoDao" ref="productoDao"/>
    </bean>
    
	<jaxws:endpoint id="productoServiceEndpoint" implementor="#productoService"
		address="/ProductoService" />


    <!-- Database Objects -->
    <!-- Drives transactions in a local Hibernate environment -->
    <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <!-- Creates an in-memory "productos" database populated with test data for fast testing -->  
    <bean id="dataSource" class="pe.edu.upc.dsd.ws.db.DataSourceFactory">
      <property name="testDatabaseName" value="productos"/>
      <property name="schemaLocation" value="classpath:/db/schema.sql"/>
      <property name="testDataLocation" value="classpath:/db/data.sql"/>
    </bean>

    <!-- Creates Hibernate Sessions to map Account and Restaurant objects -->
    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="mappingLocations">
                <list>
                    <value>classpath:/mapping/producto.hbm.xml</value>
                    <value>classpath:/mapping/queries.hbm.xml</value>
                </list>
        </property>
        <property name="hibernateProperties">
          <props>
            <prop key="hibernate.format_sql">true</prop>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
            <prop key="hibernate.current_session_context_class">thread</prop>
             <prop key="hibernate.show_sql">true</prop>
          </props>
        </property>
    </bean>

</beans>